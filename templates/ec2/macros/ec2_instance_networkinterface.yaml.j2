{%- macro prep(network_interfaces) %}
      NetworkInterfaces:
{%- for networkinterface in network_interfaces %}
        -
{%- if networkinterface.associate_public_ip_address is defined %}
          AssociatePublicIpAddress: {{ networkinterface.associate_public_ip_address }}
{%- endif %}
{%- if networkinterface.delete_on_termination is defined %}
          DeleteOnTermination: {{ networkinterface.delete_on_termination }}
{%- endif %}
{%- if networkinterface.description is defined %}
          Description: {{ networkinterface.description }}
{%- endif %}
{%- if networkinterface.device_index is defined %}
          DeviceIndex: {{ networkinterface.device_index }}
{%- endif %}
{%- if networkinterface.group_set is defined %}
          GroupSet:
{%- for item in networkinterface.group_set %}
            - {{ item }}
{%- endfor %}
{%- endif %}
{%- if networkinterface.ipv6_address_count is defined %}
          Ipv6AddressCount: {{ networkinterface.ipv6_address_count }}
{%- endif %}
{%- if networkinterface.ipv6_addresses is defined %}
          Ipv6Addresses:
{%- for ipv6address in networkinterface.ipv6_addresses %}
            - Ipv6Address: {{ ipv6address.Ipv6Address }}
{%- endfor %}
{%- endif %}
{%- if networkinterface.network_interface_id is defined %}
          NetworkInterfaceId: {{ networkinterface.network_interface_id | trim }}
{%- endif %}
{%- if networkinterface.private_ip_address is defined %}
          PrivateIpAddress: {{ networkinterface.private_ip_address }}
{%- endif %}
{%- if networkinterface.private_ip_addresses is defined %}
          PrivateIpAddresses:
{%- for specification in networkinterface.private_ip_addresses %}
            - Primary: {{ specification.primary }}
              PrivateIpAddress: {{ specification.private_ip_address }}
{%- endfor %}
{%- endif %}
{%- if networkinterface.secondary_private_ip_address_count is defined %}
          SecondaryPrivateIpAddressCount: {{ networkinterface.secondary_private_ip_address_count }}
{%- endif %}
{%- if networkinterface.subnet_id is defined %}
          SubnetId: {{ networkinterface.subnet_id | trim }}
{%- endif %}
{%- endfor %}
{%- endmacro %}